<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>templates/file/upload_form.html</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
<style>
	.drop-zone{
		height: 100px;
		border: 3px solid #cecece;
		border-radius: 10px;
		display: flex;
		justify-content: center; /* 좌우로 가운데 정렬 */
		align-items: center; /* 위아래로 가운데 정렬 */
		cursor: pointer;
	}
</style>
</head>
<body>
	<div class="container">
		<h3>파일 업로드</h3>
		<form th:action="@{/file/upload}" method="post" enctype="multipart/form-data">
		<div>
			<label for="title" class="form-label">제목</label>
			<input type="text" name="title" id="title" class="form-control"/>
		</div>
		<div>
			<label for="file" class="form-label">파일</label>
			<input style="display: none" type="file" name="file" id="file" class="form-control"/>
		</div>
		<div class="drop-zone">Drag and Drop or click here</div>
		<button type="submit" class="btn btn-primary">업로드</button>	
		</form>
	</div>
	<script>
		const dropZone = document.querySelector(".drop-zone");
		dropZone.addEventListener("dragover", (e)=>{
			e.preventDefault(); //기본 이벤트 막기
		});
		
		dropZone.addEventListener("drop", (e)=>{
			e.preventDefault(); //기본 이벤트 막기
			
			// event 객체 e 에는 drop 된 파일에 대한 정보가 들어 있다.
			const files = e.dataTransfer.files;
			if(files.length > 1){
				alert("하나의 파일만 drag drop하세요");
				return;
			}
			
			const file = files[0];
			console.log(file);
			document.querySelector("#file").files = files;
			dropZone.innerText = file.name;
		});
		
		dropZone.addEventListener("click", ()=>{
			document.querySelector("#file").click();
		});
		
		document.querySelector("#file").addEventListener("change", (e)=>{
			const files = e.target.files;
			const file = files[0];
			dropZone.innerText = file.name;
		});
	</script>
</body>
</html>